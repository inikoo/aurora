ALTER TABLE `Payment Service Provider Dimension` CHANGE `Service Provider Last Used Date` `Payment Service Provider Last Used Date` DATETIME NULL DEFAULT NULL;
ALTER TABLE `Payment Service Provider Dimension` ADD `Payment Service Provider Accounts` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Payment Service Provider Last Used Date`, ADD `Payment Service Provider Transactions` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Payment Service Provider Accounts`, ADD `Payment Service Provider Payments Amount` DECIMAL(16,2) NOT NULL DEFAULT '0' AFTER `Payment Service Provider Transactions`, ADD `Payment Service Provider Refunds Amount` DECIMAL(16,2) NOT NULL DEFAULT '0' AFTER `Payment Service Provider Payments Amount`, ADD `Payment Service Provider Balance` DECIMAL(16,2) NOT NULL DEFAULT '0' AFTER `Payment Service Provider Refunds Amount`;
ALTER TABLE `Payment Service Provider Dimension` ADD `Payment Service Provider Currency` TEXT NOT NULL AFTER `Payment Service Provider Transactions`;
ALTER TABLE `Payment Account Dimension` ADD `Payment Account Currency` TEXT NOT NULL AFTER `Payment Account Settings`, ADD `Payment Account Transactions` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Payment Account Currency`, ADD `Payment Account Payments Amount` DECIMAL(16,2) NOT NULL DEFAULT '0' AFTER `Payment Account Transactions`, ADD `Payment Account Refunds Amount` DECIMAL(16,2) NOT NULL DEFAULT '0' AFTER `Payment Account Payments Amount`, ADD `Payment Account Balance Amount` DECIMAL(16,2) NOT NULL DEFAULT '0' AFTER `Payment Account Refunds Amount`;
ALTER TABLE `Payment Service Provider Dimension` CHANGE `Payment Service Provider Balance` `Payment Service Provider Balance Amount` DECIMAL(16,2) NOT NULL DEFAULT '0.00';
CREATE TABLE IF NOT EXISTS `Payment Service Provider History Bridge` (
  `Payment Service Provider Key` mediumint(8) unsigned NOT NULL,
  `History Key` int(10) unsigned NOT NULL,
  `Deletable` enum('Yes','No') NOT NULL DEFAULT 'No',
  `Strikethrough` enum('Yes','No') NOT NULL DEFAULT 'No',
  `Type` enum('Notes','Changes') NOT NULL DEFAULT 'Notes'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `Payment Service Provider History Bridge`
  ADD PRIMARY KEY (`Payment Service Provider Key`,`History Key`),
  ADD KEY `Payment Service Provider Key` (`Payment Service Provider Key`),
  ADD KEY `History Key` (`History Key`),
  ADD KEY `Deletable` (`Deletable`),
  ADD KEY `Type` (`Type`);
  
  CREATE TABLE IF NOT EXISTS `Payment Account History Bridge` (
  `Payment Account Key` mediumint(8) unsigned NOT NULL,
  `History Key` int(10) unsigned NOT NULL,
  `Deletable` enum('Yes','No') NOT NULL DEFAULT 'No',
  `Strikethrough` enum('Yes','No') NOT NULL DEFAULT 'No',
  `Type` enum('Notes','Changes') NOT NULL DEFAULT 'Notes'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `Payment Account History Bridge`
  ADD PRIMARY KEY (`Payment Account Key`,`History Key`),
  ADD KEY `Payment Account Key` (`Payment Account Key`),
  ADD KEY `History Key` (`History Key`),
  ADD KEY `Deletable` (`Deletable`),
  ADD KEY `Type` (`Type`);
  
   CREATE TABLE IF NOT EXISTS `Payment History Bridge` (
  `Payment Key` mediumint(8) unsigned NOT NULL,
  `History Key` int(10) unsigned NOT NULL,
  `Deletable` enum('Yes','No') NOT NULL DEFAULT 'No',
  `Strikethrough` enum('Yes','No') NOT NULL DEFAULT 'No',
  `Type` enum('Notes','Changes') NOT NULL DEFAULT 'Notes'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `Payment History Bridge`
  ADD PRIMARY KEY (`Payment Key`,`History Key`),
  ADD KEY `Payment Key` (`Payment Key`),
  ADD KEY `History Key` (`History Key`),
  ADD KEY `Deletable` (`Deletable`),
  ADD KEY `Type` (`Type`);
  
//======^ done  
  
CREATE TABLE IF NOT EXISTS `User API Dimension` (
  `User API Key` int(11) NOT NULL,
  `User Key` mediumint(8) unsigned NOT NULL,
  `Valid Until` datetime DEFAULT NULL,
  `Valid IP` varchar(64) DEFAULT NULL,
  `API Public Key` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `User API Dimension`
  ADD PRIMARY KEY (`User API Key`);
ALTER TABLE `User API Dimension`
  MODIFY `User API Key` int(11) NOT NULL AUTO_INCREMENT;
  
  CREATE TABLE IF NOT EXISTS `Staff Timesheet Dimension` (
  `Staff Timesheet Key` mediumint(9) NOT NULL,
  `Staff Key` mediumint(8) unsigned NOT NULL,
  `Date` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `Staff Timesheet Dimension`
  ADD PRIMARY KEY (`Staff Timesheet Key`);
ALTER TABLE `Staff Timesheet Dimension`
  MODIFY `Staff Timesheet Key` mediumint(9) NOT NULL AUTO_INCREMENT;
  
ALTER TABLE `Staff Dimension` CHANGE `Staff Type` `Staff Type` ENUM('Employee','Volunteer','Contractor','TemporalWorker','WorkExperience','Temporal Worker','Work Experience') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Employee';
update `Staff Dimension` set `Staff Type`='TemporalWorker' where `Staff Type`='Temporal Worker';
 update `Staff Dimension` set `Staff Type`='WorkExperience' where `Staff Type`='Work Experience';
ALTER TABLE `Staff Dimension` CHANGE `Staff Type` `Staff Type` ENUM('Employee','Volunteer','Contractor','TemporalWorker','WorkExperience') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Employee';

ALTER TABLE `Staff Dimension` ADD `Staff Job Title` VARCHAR(255) NULL AFTER `Staff Type`;
  
CREATE TABLE IF NOT EXISTS `Staff Supervisor Bridge` (
  `Staff Key` mediumint(8) unsigned NOT NULL,
  `Supervisor Key` mediumint(8) unsigned NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `Staff Supervisor Bridge`
  ADD PRIMARY KEY (`Staff Key`,`Supervisor Key`);

ALTER TABLE `Staff Dimension`  DROP `Staff Contact Key`;  

ALTER TABLE `Staff Dimension` ADD `Staff Birthday` DATETIME NULL DEFAULT NULL AFTER `Staff Name`, ADD `Staff Official ID` VARCHAR(255) NULL DEFAULT NULL AFTER `Staff Birthday`, ADD `Staff Email` VARCHAR(255) NULL DEFAULT NULL AFTER `Staff Official ID`, ADD `Staff Telephone` VARCHAR(255) NULL DEFAULT NULL AFTER `Staff Email`, ADD `Staff Next of Kind` VARCHAR(1024) NULL DEFAULT NULL AFTER `Staff Telephone`;
ALTER TABLE `Staff Dimension` ADD `Staff Telephone Formated` VARCHAR(255) NULL DEFAULT NULL AFTER `Staff Telephone`;
ALTER TABLE `Staff Dimension` CHANGE `Staff PIN` `Staff PIN` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;
ALTER TABLE `Account Dimension` ADD `Employees` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Warehouses`;
ALTER TABLE `Staff Dimension` CHANGE `Staff ID` `Staff ID` VARCHAR(64) NULL DEFAULT NULL;
ALTER TABLE `Staff Dimension` CHANGE `Staff Valid from` `Staff Valid From` DATETIME NULL DEFAULT NULL;


//==

DROP TABLE `User API Dimension`;

ALTER TABLE `Staff Dimension` ADD `Staff Working Hours` TEXT NULL DEFAULT NULL AFTER `Staff Is Supervisor`;
ALTER TABLE `Staff Dimension` ADD `Staff Salary` TEXT NULL AFTER `Staff Working Hours`;

//

DELETE FROM `User Group User Bridge` WHERE `User Group Key` in (4);

//========


ALTER TABLE `Timesheet Dimension` ADD `Timesheet Working Hours Records` TINYINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Staff Key`, ADD `Timesheet Overtime Records` TINYINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Working Hours Records`;
ALTER TABLE `Timesheet Dimension` CHANGE `Timesheet Clocking Records` `Timesheet Clocking Records` SMALLINT UNSIGNED NOT NULL DEFAULT '0', CHANGE `Timesheet Ignored Clocking Records` `Timesheet Ignored Clocking Records` SMALLINT UNSIGNED NOT NULL DEFAULT '0';
ALTER TABLE `Timesheet Record Dimension` CHANGE `Timesheet Record Source` `Timesheet Record Source` ENUM('ClockingMachine','Manual','API','System') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT 'Manual';

ALTER TABLE `Timesheet Record Dimension` DROP INDEX `Staff Key`, ADD UNIQUE `Staff Key` (`Timesheet Record Staff Key`, `Timesheet Record Date`, `Timesheet Record Type`) USING BTREE;

ALTER TABLE `Timesheet Dimension` ADD `Timesheet Type` ENUM('WorkingDay','DayOff','NoFixedWorkingHours') NULL AFTER `Timesheet Date`;
ALTER TABLE `Timesheet Dimension` CHANGE `Timesheet Type` `Timesheet Type` ENUM('WorkingDay','DayOff','NoFixedWorkingHours') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT 'NoFixedWorkingHours';
ALTER TABLE `Timesheet Record Dimension` CHANGE `Timesheet Record Type` `Timesheet Record Type` ENUM('WorkingHoursMark','OvertimeMark','ClockingRecord','BreakMark') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'ClockingRecord';
ALTER TABLE `Timesheet Dimension` ADD `Timesheet Break Records` TINYINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Working Hours Records`;

ALTER TABLE `Timesheet Record Dimension` CHANGE `Timesheet Record Action Type` `Timesheet Record Action Type` ENUM('Start','End','Unknown','Ignored','MarkStart','MarkEnd') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Unknown';
ALTER TABLE `Timesheet Dimension` ADD `Timesheet Working Hours` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Clocked Hours`, ADD `Timesheet Unpaid Overtime` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Working Hours`, ADD `Timesheet Paid Overtime` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Unpaid Overtime`;
ALTER TABLE `Timesheet Dimension` CHANGE `Timesheet Working Hours` `Timesheet Working Time` MEDIUMINT(8) UNSIGNED NOT NULL DEFAULT '0';

ALTER TABLE `Timesheet Dimension` CHANGE `Timesheet Clocked Hours` `Timesheet Clocked Time` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0';
ALTER TABLE `Timesheet Record Dimension` CHANGE `Timesheet Record Action Type` `Timesheet Record Action Type` ENUM('MarkStart','Start','End','MarkEnd','Ignored','Unknown') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Unknown';
ALTER TABLE `Timesheet Dimension` ADD `Timesheet Breaks Time` MEDIUMINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Working Time`;
update `Staff Dimension` set `Staff Valid From`=NULL where  `Staff Valid From`='0000-00-00 00:00:00';
update `Staff Dimension` set `Staff Valid To`=NULL where  `Staff Valid To`='0000-00-00 00:00:00';

ALTER TABLE `Timesheet Dimension` ADD INDEX (`Timesheet Date`);


//============

ALTER TABLE `Timesheet Record Dimension` ADD `Timesheet Record Ignored Due Missing End` ENUM('Yes','No') NOT NULL DEFAULT 'No' AFTER `Timesheet Record Ignored`, ADD INDEX (`Timesheet Record Ignored Due Missing End`);
update `Timesheet Record Dimension` set `Timesheet Record Ignored Due Missing End`= `Timesheet Record Ignored`;
ALTER TABLE `Timesheet Dimension` ADD `Timesheet Missing Clocking Records` SMALLINT UNSIGNED NOT NULL DEFAULT '0' AFTER `Timesheet Ignored Clocking Records`;

//=======

CREATE TABLE IF NOT EXISTS `Attachment Bridge History Bridge` (
  `Attachment Bridge Key` mediumint(8) unsigned NOT NULL,
  `History Key` int(10) unsigned NOT NULL,
  `Deletable` enum('Yes','No') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'No',
  `Strikethrough` enum('Yes','No') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'No',
  `Type` enum('Notes','Changes') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
ALTER TABLE `Attachment Bridge History Bridge` ADD PRIMARY KEY (`Attachment Bridge Key`, `History Key`);
ALTER TABLE `Attachment Bridge History Bridge` ADD INDEX (`Attachment Bridge Key`);
ALTER TABLE `Attachment Bridge History Bridge` ADD INDEX (`Attachment Bridge Key`);
ALTER TABLE `Attachment Bridge History Bridge` ADD INDEX (`History Key`);
ALTER TABLE `Attachment Bridge History Bridge` ADD INDEX (`Type`);




  
  INSERT INTO `Overtime Dimension` (`Overtime Key`, `Overtime Reference`, `Overtime Status`, `Overtime Start Date`, `Overtime End Date`, `Overtime Metadata`, `Overtime Type`, `Overtime Timesheets Entitled`, `Overtime Timesheets Granted`, `Overtime Staff Entitled`, `Overtime Staff Granted`, `Overtime Time`, `Overtime Paid Amount`, `Overtime Accrued Time`) VALUES (NULL, 'Xmas overtime W&P', 'Active', '2015-10-01 00:00:00', '2015-12-06 23:59:59', '{"data":{"amount_weekdays":7.44,"amount_saturday":15.44,"amount_sunday":15.44}}', 'Pay', '0', '0', '0', '0', '0', '0', '0');

  